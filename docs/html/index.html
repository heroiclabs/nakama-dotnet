<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Nakama .NET Client SDK: Nakama .NET</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="nakama_logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Nakama .NET Client SDK<span id="projectnumber">&#160;3.8.0</span>
   </div>
   <div id="projectbrief">Nakama .NET Client SDK</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title"><a class="el" href="namespace_nakama.html">Nakama</a> .NET </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__2_users_2gp_2_git_hub_2nakama-dotnet_2_r_e_a_d_m_e"></a></p>
<h1><a class="el" href="namespace_nakama.html">Nakama</a></h1>
<blockquote class="doxtable">
<p>&zwj;.NET client for <a class="el" href="namespace_nakama.html">Nakama</a> server written in C#. </p>
</blockquote>
<p><a href="https://github.com/heroiclabs/nakama">Nakama</a> is an open-source server designed to power modern games and apps. Features include user accounts, chat, social, matchmaker, realtime multiplayer, and much <a href="https://heroiclabs.com">more</a>.</p>
<p>This client implements the full API and socket options with the server. It's written in C# with minimal dependencies to support Unity, Xamarin, Godot, XNA, and other engines and frameworks.</p>
<p>Full documentation is online - <a href="https://heroiclabs.com/docs">https://heroiclabs.com/docs</a></p>
<h2>Getting Started</h2>
<p>You'll need to setup the server and database before you can connect with the client. The simplest way is to use Docker but have a look at the <a href="https://github.com/heroiclabs/nakama#getting-started">server documentation</a> for other options.</p>
<ol type="1">
<li>Install and run the servers. Follow these <a href="https://heroiclabs.com/docs/install-docker-quickstart">instructions</a>.</li>
<li>Download the client from the <a href="https://github.com/heroiclabs/nakama-dotnet/releases">releases page</a> and import it into your project. You can also build from source.</li>
<li><p class="startli">Use the connection credentials to build a client object.</p>
<div class="fragment"><div class="line"><span class="comment">// using Nakama;</span></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">string</span> scheme = <span class="stringliteral">&quot;http&quot;</span>;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">string</span> host = <span class="stringliteral">&quot;127.0.0.1&quot;</span>;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> port = 7350;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">string</span> serverKey = <span class="stringliteral">&quot;defaultkey&quot;</span>;</div>
<div class="line">var client = <span class="keyword">new</span> Client(scheme, host, port, serverKey);</div>
</div><!-- fragment --></li>
</ol>
<h2>Usage</h2>
<p>The client object has many methods to execute various features in the server or open realtime socket connections with the server.</p>
<h3>Authenticate</h3>
<p>There's a variety of ways to <a href="https://heroiclabs.com/docs/authentication">authenticate</a> with the server. Authentication can create a user if they don't already exist with those credentials. It's also easy to authenticate with a social profile from Google Play Games, Facebook, Game Center, etc.</p>
<div class="fragment"><div class="line">var email = <span class="stringliteral">&quot;super@heroes.com&quot;</span>;</div>
<div class="line">var password = <span class="stringliteral">&quot;batsignal&quot;</span>;</div>
<div class="line">var session = await client.AuthenticateEmailAsync(email, password);</div>
<div class="line">System.Console.WriteLine(session);</div>
</div><!-- fragment --><h3>Sessions</h3>
<p>When authenticated the server responds with an auth token (JWT) which contains useful properties and gets deserialized into a <code>Session</code> object.</p>
<div class="fragment"><div class="line">System.Console.WriteLine(session.AuthToken); <span class="comment">// raw JWT token</span></div>
<div class="line">System.Console.WriteLine(session.RefreshToken); <span class="comment">// raw JWT token.</span></div>
<div class="line">System.Console.WriteLine(session.UserId);</div>
<div class="line">System.Console.WriteLine(session.Username);</div>
<div class="line">System.Console.WriteLine(<span class="stringliteral">&quot;Session has expired: {0}&quot;</span>, session.IsExpired);</div>
<div class="line">System.Console.WriteLine(<span class="stringliteral">&quot;Session expires at: {0}&quot;</span>, session.ExpireTime);</div>
</div><!-- fragment --><p>It is recommended to store the auth token from the session and check at startup if it has expired. If the token has expired you must reauthenticate. The expiry time of the token can be changed as a setting in the server.</p>
<div class="fragment"><div class="line">var authToken = <span class="stringliteral">&quot;restored from somewhere&quot;</span>;</div>
<div class="line">var refreshToken = <span class="stringliteral">&quot;restored from somewhere&quot;</span>;</div>
<div class="line">var session = Session.Restore(authToken, refreshToken);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Check whether a session is close to expiry.</span></div>
<div class="line"><span class="keywordflow">if</span> (session.HasExpired(DateTime.UtcNow.AddDays(1)))</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">        session = await client.SessionRefreshAsync(session);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (ApiResponseException e)</div>
<div class="line">    {</div>
<div class="line">        System.Console.WriteLine(<span class="stringliteral">&quot;Session can no longer be refreshed. Must reauthenticate!&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>:warning: NOTE: The length of the lifetime of a session can be set on the server with the "--session.token_expiry_sec" command flag argument. The lifetime of the refresh token for a session can be set on the server with the "--session.refresh_token_expiry_sec" command flag.</p>
<h3>Requests</h3>
<p>The client includes lots of builtin APIs for various features of the game server. These can be accessed with the async methods. It can also call custom logic in RPC functions on the server. These can also be executed with a socket object.</p>
<p>All requests are sent with a session object which authorizes the client.</p>
<div class="fragment"><div class="line">var account = await client.GetAccountAsync(session);</div>
<div class="line">System.Console.WriteLine(account.User.Id);</div>
<div class="line">System.Console.WriteLine(account.User.Username);</div>
<div class="line">System.Console.WriteLine(account.Wallet);</div>
</div><!-- fragment --><p>Requests can be supplied with a retry configurations in cases of transient network or server errors.</p>
<p>A single configuration can be used to control all request retry behavior:</p>
<div class="fragment"><div class="line">var retryConfiguration = <span class="keyword">new</span> RetryConfiguration(baseDelayMs: 1000, maxRetries: 5, delegate { System.Console.Writeline(<span class="stringliteral">&quot;about to retry.&quot;</span>); });</div>
<div class="line"> </div>
<div class="line">client.GlobalRetryConfiguration = retryConfiguration;</div>
<div class="line">var account = await client.GetAccountAsync(session);</div>
</div><!-- fragment --><p>Or, the configuration can be supplied on a per-request basis:</p>
<div class="fragment"><div class="line">var retryConfiguration = <span class="keyword">new</span> RetryConfiguration(baseDelayMs: 1000, maxRetries: 5, delegate { System.Console.Writeline(<span class="stringliteral">&quot;about to retry.&quot;</span>); });</div>
<div class="line"> </div>
<div class="line">var account = await client.GetAccountAsync(session, retryConfiguration);</div>
</div><!-- fragment --><p>Per-request retry configurations override the global retry configuration.</p>
<p>Requests also can be supplied with a cancellation token if you need to cancel them mid-flight:</p>
<div class="fragment"><div class="line">var canceller = <span class="keyword">new</span> CancellationTokenSource();</div>
<div class="line">var account = await client.GetAccountAsync(session, retryConfiguration: null, canceller);</div>
<div class="line"> </div>
<div class="line">await Task.Delay(25);</div>
<div class="line"> </div>
<div class="line">canceller.Cancel(); <span class="comment">// will raise a TaskCanceledException</span></div>
</div><!-- fragment --><h3>Socket</h3>
<p>The client can create one or more sockets with the server. Each socket can have it's own event listeners registered for responses received from the server.</p>
<div class="fragment"><div class="line">var socket = Socket.From(client);</div>
<div class="line">socket.Connected += () =&gt;</div>
<div class="line">{</div>
<div class="line">    System.Console.WriteLine(<span class="stringliteral">&quot;Socket connected.&quot;</span>);</div>
<div class="line">};</div>
<div class="line">socket.Closed += () =&gt;</div>
<div class="line">{</div>
<div class="line">    System.Console.WriteLine(<span class="stringliteral">&quot;Socket closed.&quot;</span>);</div>
<div class="line">};</div>
<div class="line">socket.ReceivedError += e =&gt; System.Console.WriteLine(e);</div>
<div class="line">await socket.ConnectAsync(session);</div>
</div><!-- fragment --><h1><a class="el" href="namespace_satori.html">Satori</a></h1>
<p><a class="el" href="namespace_satori.html">Satori</a> is a liveops server for games that powers actionable analytics, A/B testing and remote configuration. Use the <a class="el" href="namespace_satori.html">Satori</a> .NET Client to coomunicate with <a class="el" href="namespace_satori.html">Satori</a> from within your .NET game.</p>
<p>Full documentation is online - <a href="https://heroiclabs.com/docs/satori/client-libraries/unity/index.html">https://heroiclabs.com/docs/satori/client-libraries/unity/index.html</a></p>
<h2>Getting Started</h2>
<p>Create a client object that accepts the API you were given as a <a class="el" href="namespace_satori.html">Satori</a> customer.</p>
<div class="fragment"><div class="line"><span class="keyword">using </span><a class="code hl_namespace" href="namespace_satori.html">Satori</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">string</span> scheme = <span class="stringliteral">&quot;https&quot;</span>;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">string</span> host = <span class="stringliteral">&quot;127.0.0.1&quot;</span>; <span class="comment">// add your host here</span></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> port = 443;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">string</span> apiKey = <span class="stringliteral">&quot;apiKey&quot;</span>; <span class="comment">// add the api key that was given to you as a Satori customer.</span></div>
<div class="line"> </div>
<div class="line">var client = <span class="keyword">new</span> <a class="code hl_class" href="class_satori_1_1_client.html">Client</a>(scheme, host, port, apiKey);</div>
<div class="ttc" id="aclass_satori_1_1_client_html"><div class="ttname"><a href="class_satori_1_1_client.html">Satori.Client</a></div><div class="ttdef"><b>Definition</b> Satori/Client.cs:24</div></div>
<div class="ttc" id="anamespace_satori_html"><div class="ttname"><a href="namespace_satori.html">Satori</a></div><div class="ttdef"><b>Definition</b> Satori/ApiClient.gen.cs:3</div></div>
</div><!-- fragment --><p>Then authenticate with the server to obtain your session.</p>
<div class="fragment"><div class="line"><span class="comment">// Authenticate with the Satori server.</span></div>
<div class="line"><span class="keywordflow">try</span></div>
<div class="line">{</div>
<div class="line">    session = await client.AuthenticateAsync(<span class="keywordtype">id</span>);</div>
<div class="line">    Debug.Log(<span class="stringliteral">&quot;Authenticated successfully.&quot;</span>);</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">catch</span>(<a class="code hl_class" href="class_satori_1_1_api_response_exception.html">ApiResponseException</a> ex)</div>
<div class="line">{</div>
<div class="line">    Debug.LogFormat(<span class="stringliteral">&quot;Error authenticating: {0}&quot;</span>, ex.Message);</div>
<div class="line">}</div>
<div class="ttc" id="aclass_satori_1_1_api_response_exception_html"><div class="ttname"><a href="class_satori_1_1_api_response_exception.html">Satori.ApiResponseException</a></div><div class="ttdoc">An exception generated for HttpResponse objects don't return a success status.</div><div class="ttdef"><b>Definition</b> Satori/ApiClient.gen.cs:16</div></div>
</div><!-- fragment --><p>Using the client you can get any experiments or feature flags, the user belongs to.</p>
<div class="fragment"><div class="line">var experiments = await client.GetExperimentsAsync(session);</div>
<div class="line">var flag = await client.GetFlagAsync(session, <span class="stringliteral">&quot;FlagName&quot;</span>);</div>
</div><!-- fragment --><p>You can also send arbitrary events to the server:</p>
<div class="fragment"><div class="line">await client.EventAsync(session, <span class="keyword">new</span> <a class="code hl_class" href="class_satori_1_1_event.html">Event</a>(<span class="stringliteral">&quot;gameLaunched&quot;</span>, DateTime.UtcNow));</div>
<div class="ttc" id="aclass_satori_1_1_event_html"><div class="ttname"><a href="class_satori_1_1_event.html">Satori.Event</a></div><div class="ttdoc">An event to be published to the server.</div><div class="ttdef"><b>Definition</b> Event.cs:25</div></div>
</div><!-- fragment --><p> This is only a subset of the <a class="el" href="namespace_satori.html">Satori</a> client API, so please see the documentation link listed earlier for the <a href="https://dotnet.docs.heroiclabs.com/html/namespace_satori.html">full API</a>.</p>
<h1>Contribute</h1>
<p>The development roadmap is managed as GitHub issues and pull requests are welcome. If you're interested to improve the code please open an issue to discuss the changes or drop in and discuss it in the <a href="https://forum.heroiclabs.com">community forum</a>.</p>
<h2>Source Builds</h2>
<p>The codebase can be built with the <a href="https://docs.microsoft.com/en-us/dotnet/core/tools">Dotnet CLI</a>. All dependencies are downloaded at build time with Nuget.</p>
<div class="fragment"><div class="line">dotnet build Nakama/Nakama.csproj</div>
</div><!-- fragment --><div class="fragment"><div class="line">dotnet build Satori/Satori.csproj</div>
</div><!-- fragment --><p>For release builds see our instructions:</p>
<h2>Run Tests</h2>
<p>To run tests you will need to run the server and database. Most tests are written as integration tests which execute against the server. A quick approach we use with our test workflow is to use the Docker compose file described in the <a href="https://heroiclabs.com/docs/install-docker-quickstart">documentation</a>.</p>
<div class="fragment"><div class="line">docker-compose -f ./docker-compose-postgres.yml up</div>
<div class="line">dotnet test Nakama.Tests/Nakama.Tests.csproj</div>
</div><!-- fragment --><p>To run a specific test, pass the fully qualified name of the method to <code>dotnet test --filter</code>:</p>
<div class="fragment"><div class="line">dotnet test --filter &quot;Nakama.Tests.Api.GroupTest.ShouldPromoteAndDemoteUsers&quot;</div>
</div><!-- fragment --><p>If you'd like to attach a Visual Studio debugger to a test, set <code>VSTEST_HOST_DEBUG</code> to <code>true</code> in your shell environment and run <code>dotnet test</code>. Attach the debugger to the process identified by the console.</p>
<p>In order to pass tests for <a class="el" href="namespace_satori.html">Satori</a>, the <a class="el" href="namespace_satori.html">Satori</a> console must be populated with sample data available via a button in its GUI. Then you can test the SDK with <code>dotnet test Satori.Tests/Satori.Tests.csproj</code>.</p>
<h2>Generate Docs</h2>
<p>nakama-dotnet API docs are generated with Doxygen and deployed to GitHub pages.</p>
<p>When changing the API comments, rerun Doxygen and commit the changes in <code>docs/*</code>.</p>
<p>To run Doxygen:</p>
<div class="fragment"><div class="line">brew install doxygen</div>
<div class="line">cd docs/</div>
<div class="line">doxygen</div>
</div><!-- fragment --><h1>Licenses</h1>
<p>This project is licensed under the <a href="https://github.com/heroiclabs/nakama-dotnet/blob/master/LICENSE">Apache-2 License</a>.</p>
<h1>Special Thanks</h1>
<p>Thanks to Alex Parker (@zanders3) for the excellent <a href="https://github.com/zanders3/json">json</a> library and David Haig (@ninjasource) for <a href="https://github.com/ninjasource/Ninja.WebSockets">Ninja.WebSockets</a>. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
